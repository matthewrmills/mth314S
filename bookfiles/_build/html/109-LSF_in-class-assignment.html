
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>109 In-Class Assignment: Least Squares Fit (LSF) &#8212; Matrix Algebra with Computational Applications</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="109 Pre-Class Assignment: Least Squares Fit (Regression) and Review" href="109--LSF_Review_pre-class-assignment.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Matrix Algebra with Computational Applications</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="101-Welcome_and_Vectors_in-class-assignment.html">
   101 - In-class Assignment: Welcome and Introduction to Vectors
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="102--Matrix_Mechanics_pre-class-assignment.html">
   102-Pre-class Assignment: Python Linear Algebra Packages and Matrix Mechanics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="102-Matrix_Mechanics_in-class-assignment.html">
   102 - Matrices and Matrix Multiplication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="103--Linear_Equations_pre-class-assignment.html">
   103 Pre-Class Assignment: Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="103-Linear_Equations_in-class-assignment.html">
   103 In-Class Assignment: Solving Linear Systems of equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="104--Affine_Transformations_Robotics_pre-class-assignment.html">
   104 Pre-Class Assignment: Transformations &amp; Robotics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="104-Affine_Transformations_Robotics_in-class-assignment.html">
   104 In-Class Assignment: Transformations &amp; Robotics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="105--Determinants_Eigenvectors_pre-class-assignment.html">
   105 Pre-Class Assignment: Determinants and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="105-Determinants_Eigenvectors_in-class-assignment.html">
   105 In-Class Assignment: Determinants &amp; Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="106--Diagonalization_Linear_Dynamical_Systems_pre-class-assignment.html">
   106 Pre-Class Assignment: Diagonalization &amp; Linear Dynamical Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="106-Diagonalization_Linear_System_in-class-assignment.html">
   106 In-Class Assignment: Diagonalization &amp; Linear Dynamical Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="107--Vector_Spaces_pre-class-assignment.html">
   107 Pre-Class Assignment: Vector Spaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="107-Vector_spaces_in-class-assignment.html">
   107 In-Class Assignment: Vector Spaces &amp; Fundamental Spaces of a Matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="108--Basis_Orthog_IP_pre-class-assignment.html">
   108 Pre-Class Assignment: Change of Basis,  Orthogonal, Inner Product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="108-Basis_Orthogonal_InnerProduct_in-class-assignment.html">
   108 In-Class Assignment: Change of Basis, Projections, Inner Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="109--LSF_Review_pre-class-assignment.html">
   109 Pre-Class Assignment: Least Squares Fit (Regression) and Review
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   109 In-Class Assignment: Least Squares Fit (LSF)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/109-LSF_in-class-assignment.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/matthewrmills/mth314s"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/matthewrmills/mth314s/issues/new?title=Issue%20on%20page%20%2F109-LSF_in-class-assignment.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/matthewrmills/mth314s/main?urlpath=lab/tree/docs/_sources/109-LSF_in-class-assignment.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   109 In-Class Assignment: Least Squares Fit (LSF)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agenda-for-today-s-class">
     Agenda for today’s class
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sirs">
   1. SIRS
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-the-best-solution-in-an-overdetermined-system">
   2. Finding the best solution in an overdetermined system
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pseudoinverse">
   3. Pseudoinverse
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-know-there-is-a-psudoinverse">
     How do we know there is a Psudoinverse
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lsf-example-tracking-the-planets">
     4. LSF Example: Tracking the Planets
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lsf-example-predator-pray-model">
     5. LSF Example: Predator Pray Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lsf-example-estimating-the-best-ellipses">
     6. LSF Example: Estimating the best Ellipses
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="in-class-assignment-least-squares-fit-lsf">
<h1>109 In-Class Assignment: Least Squares Fit (LSF)<a class="headerlink" href="#in-class-assignment-least-squares-fit-lsf" title="Permalink to this headline">¶</a></h1>
<img alt="image showing a 3D vector projected onto a 2D plane" src="https://lh5.googleusercontent.com/RFgtgkULxOPzUC8lwl1j265FjpzaD2YIDHjy94VyqOOU7xIQf03bsHDSmxYNOmYDXeLPn7iMTg=w740" width="50%">
</p>
<div class="section" id="agenda-for-today-s-class">
<h2>Agenda for today’s class<a class="headerlink" href="#agenda-for-today-s-class" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#sirs">SIRS Link</a></p></li>
<li><p><a class="reference external" href="#Finding_the_best_solution_in_an_overdetermined_system">Finding the best solution in an overdetermined system</a></p></li>
<li><p><a class="reference external" href="#Pseudoinverse">Pseudoinverse</a></p></li>
<li><p><a class="reference external" href="#LSF-Example:-Tracking-the-Planets">LSF Example: Tracking the Planets</a></p></li>
<li><p><a class="reference external" href="#LSF-Example:-Predator-Pray-Model">LSF Example: Predator Pray Model</a></p></li>
<li><p><a class="reference external" href="#LSF-Example:-Estimating-the-best-Ellipses">LSF Example: Estimating the best Ellipses</a></p></li>
</ol>
<hr class="docutils" />
<p><a name="sirs"></a></p>
</div>
</div>
<div class="section" id="sirs">
<h1>1. SIRS<a class="headerlink" href="#sirs" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://sirsonline.msu.edu">SIRS</a></p></li>
</ul>
<hr class="docutils" />
<p><a name="Finding_the_best_solution_in_an_overdetermined_system"></a></p>
</div>
<div class="section" id="finding-the-best-solution-in-an-overdetermined-system">
<h1>2. Finding the best solution in an overdetermined system<a class="headerlink" href="#finding-the-best-solution-in-an-overdetermined-system" title="Permalink to this headline">¶</a></h1>
<p>Let <span class="math notranslate nohighlight">\(Ax = y\)</span> be a system of <span class="math notranslate nohighlight">\(m\)</span> linear equations in <span class="math notranslate nohighlight">\(n\)</span> variables. A <em>least squares solution</em> of <span class="math notranslate nohighlight">\(Ax = y\)</span> is an solution <span class="math notranslate nohighlight">\(\hat{x}\)</span> in <span class="math notranslate nohighlight">\(R^n\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[ \min_{\hat{x}}\|y - A\hat{x}\|.\]</div>
<p>Note we substitute <span class="math notranslate nohighlight">\(y\)</span> for our typical variable <span class="math notranslate nohighlight">\(b\)</span> here because we will use <span class="math notranslate nohighlight">\(b\)</span> later to represent the intercept to a line and we want to try and avoid confusion in notation. It also consistent with the picture above.</p>
<p>In other words, <span class="math notranslate nohighlight">\(\hat{x}\)</span> is a value of <span class="math notranslate nohighlight">\(x\)</span> for which <span class="math notranslate nohighlight">\(Ax\)</span> is as close as possible to <span class="math notranslate nohighlight">\(y\)</span>. From previous lectures, we know this to be true if the vector $<span class="math notranslate nohighlight">\(y - A\hat{x}\)</span><span class="math notranslate nohighlight">\( is orthogonal (perpendicular) to the column space of \)</span>A$.</p>
<p>We also know that the dot product is zero if two vectors are orthogonal. So we have<br />
$<span class="math notranslate nohighlight">\(a \cdot (Ax - y)  = 0, \)</span><span class="math notranslate nohighlight">\(
for all vectors \)</span>a<span class="math notranslate nohighlight">\( in the column spaces of \)</span>A$.</p>
<p>The columns of <span class="math notranslate nohighlight">\(A\)</span> span the column space of <span class="math notranslate nohighlight">\(A\)</span>. Denote the columns of <span class="math notranslate nohighlight">\(A\)</span> as
$<span class="math notranslate nohighlight">\(A = [a_1, \cdots, a_n].\)</span><span class="math notranslate nohighlight">\( 
Then we have 
\)</span><span class="math notranslate nohighlight">\(a_1^\top (Ax - y)  = 0, \\ a_2^\top(Ax-y)=0\\\vdots \\a_n^\top(Ax-y)=0.\)</span><span class="math notranslate nohighlight">\(
It is the same as taking the transpose of \)</span>A<span class="math notranslate nohighlight">\( and doing a matrix multiply:
\)</span><span class="math notranslate nohighlight">\(A^\top (Ax - y) = 0.\)</span>$</p>
<p>That is:</p>
<p><font size=40>$<span class="math notranslate nohighlight">\(A^\top Ax = A^\top y\)</span>$</font></p>
<p>The above equation is called the <em>least squares solution</em> to the original equation <span class="math notranslate nohighlight">\(Ax=y\)</span>.  The matrix <span class="math notranslate nohighlight">\(A^\top A\)</span> is symmetric and invertable. Then solving for <span class="math notranslate nohighlight">\(\hat{x}\)</span> can be calculated as follows:</p>
<div class="math notranslate nohighlight">
\[x = (A^\top A)^{-1}A^\top y\]</div>
<p>The matrix <span class="math notranslate nohighlight">\((A^\top A)^{-1}A^\top\)</span> is also called the left inverse.</p>
<p><strong>Example:</strong> A researcher has conducted experiments of a particular Hormone dosage in a population of rats. The table shows the number of fatalities at each dosage level tested. Determine the least squares line and use it to predict the number of rat fatalities at hormone dosage of 22.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Hormone level</p></th>
<th class="head"><p>20</p></th>
<th class="head"><p>25</p></th>
<th class="head"><p>30</p></th>
<th class="head"><p>35</p></th>
<th class="head"><p>40</p></th>
<th class="head"><p>45</p></th>
<th class="head"><p>50</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Fatalities</p></td>
<td><p>101</p></td>
<td><p>115</p></td>
<td><p>92</p></td>
<td><p>64</p></td>
<td><p>60</p></td>
<td><p>50</p></td>
<td><p>49</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">(</span><span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hormone Level&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fatalities&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/109-LSF_in-class-assignment_7_0.png" src="_images/109-LSF_in-class-assignment_7_0.png" />
</div>
</div>
<p>We want to determine a line that is expressed by the following equation</p>
<div class="math notranslate nohighlight">
\[f = aH + b,\]</div>
<p>to approximate the connection between Hormone dosage (<span class="math notranslate nohighlight">\(H\)</span>) and Fatalities <span class="math notranslate nohighlight">\(f\)</span>.
That is, we want to find <span class="math notranslate nohighlight">\(a\)</span> (slope) and <span class="math notranslate nohighlight">\(b\)</span> (y-intercept) for this line. First we define the variable <span class="math notranslate nohighlight">\( 
x = \left[
\begin{matrix}
    a  \\
    b  
\end{matrix}
\right] 
\)</span> as the column vector that needs to be solved.</p>
<p>✅<strong><font color=red>DO THIS:</font></strong> Rewrite the system of equations to the form <span class="math notranslate nohighlight">\(Ax=y\)</span> by defining your <code class="docutils literal notranslate"><span class="pre">numpy</span></code> matrices <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> using the data from above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>QUESTION:</font></strong> Calculate the square matrix <span class="math notranslate nohighlight">\(C = A^\top A\)</span> and the modified right hand side vector as <span class="math notranslate nohighlight">\(A^\top y\)</span> (Call it <code class="docutils literal notranslate"><span class="pre">Aty</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>QUESTION:</font></strong> Find the <em>least squares solution</em> by solving <span class="math notranslate nohighlight">\(Cx=A^\top y\)</span> for <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>QUESTION:</font></strong> Given the solution above, define the two scalars slope <code class="docutils literal notranslate"><span class="pre">a</span></code> and y-intercept <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>The following code will Plot the original data and the line estimated by the coefficients found in the above quation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>

<span class="n">H2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>

<span class="n">f2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">H2</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">H2</span><span class="p">,</span> <span class="n">f2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="mi">9</span><span class="n">bf8df9d29e8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">H2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">H2</span> <span class="o">+</span> <span class="n">b</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> 
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">H2</span><span class="p">,</span> <span class="n">f2</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;a&#39; is not defined
</pre></div>
</div>
<img alt="_images/109-LSF_in-class-assignment_17_1.png" src="_images/109-LSF_in-class-assignment_17_1.png" />
</div>
</div>
<p>✅<strong><font color=red>QUESTION:</font></strong>  Repeat the above analysis but now with a eight-order polynomial.</p>
<p>✅<strong><font color=red>QUESTION:</font></strong>  Play with the interactive function below by adjusting the degree of the least-squares fit approximation. Then extend the <code class="docutils literal notranslate"><span class="pre">x_min</span></code> and <code class="docutils literal notranslate"><span class="pre">x_max</span></code> parameters. Do you think that an eight-order polynomial is a good model for this dataset? Why or why not?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">fixed</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="nd">@interact</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">x_min</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">H</span><span class="p">)),</span> <span class="n">x_max</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">H</span><span class="p">),</span> <span class="nb">max</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">H</span><span class="p">)))</span>
<span class="k">def</span> <span class="nf">graphPolyN</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">degree</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
    <span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_pred</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<p>Put your answer to the above question here</p>
<p>✅<strong><font color=red>QUESTION:</font></strong>  Check the rank of <span class="math notranslate nohighlight">\(C=A^\top A\)</span> for the previous case. What do you get? Why?</p>
<p>Put your answer to the above question here</p>
<hr class="docutils" />
<p><a name="Pseudoinverse"></a></p>
</div>
<div class="section" id="pseudoinverse">
<h1>3. Pseudoinverse<a class="headerlink" href="#pseudoinverse" title="Permalink to this headline">¶</a></h1>
<p>In this class we often talk about solving problems of the form:</p>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<p>Currently we have determined that this problem becomes very nice when the <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> has an inverse. We can easily multiply each side by the inverse:</p>
<div class="math notranslate nohighlight">
\[A^{-1}Ax = A^{-1}b\]</div>
<p>Since <span class="math notranslate nohighlight">\(A^{-1}A = I\)</span> the solution for <span class="math notranslate nohighlight">\(x\)</span> is simply:</p>
<div class="math notranslate nohighlight">
\[x = A^{-1}b\]</div>
<p>Now, let us consider a a more general problem where the <span class="math notranslate nohighlight">\(m \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> is not square, i.e. <span class="math notranslate nohighlight">\(m \neq n\)</span> and its rank <span class="math notranslate nohighlight">\(r\)</span> maybe less than <span class="math notranslate nohighlight">\(m\)</span> and/or <span class="math notranslate nohighlight">\(n\)</span>.  In this case we want to find a Pseudoinverse (which we denote as <span class="math notranslate nohighlight">\(A^+\)</span>) which acts like an inverse for a non-square matrix. In other words we want to find an <span class="math notranslate nohighlight">\(A^+\)</span> for <span class="math notranslate nohighlight">\(A\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[A^+A \approx I\]</div>
<p>Assuming we can find the <span class="math notranslate nohighlight">\(n \times m\)</span> matrix <span class="math notranslate nohighlight">\(A^+\)</span>, we should then be able to solve for <span class="math notranslate nohighlight">\(x\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<div class="math notranslate nohighlight">
\[A^+Ax = A^+b\]</div>
<div class="math notranslate nohighlight">
\[x \approx A^+b\]</div>
<div class="section" id="how-do-we-know-there-is-a-psudoinverse">
<h2>How do we know there is a Psudoinverse<a class="headerlink" href="#how-do-we-know-there-is-a-psudoinverse" title="Permalink to this headline">¶</a></h2>
<p>Assuming the general case of a <span class="math notranslate nohighlight">\(m\times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> where its rank <span class="math notranslate nohighlight">\(r\)</span> maybe less than <span class="math notranslate nohighlight">\(m\)</span> and/or <span class="math notranslate nohighlight">\(n\)</span> (<span class="math notranslate nohighlight">\(r\leq m\)</span> and <span class="math notranslate nohighlight">\(r\leq n\)</span>). We can conclude the following about the fundamental spaces of <span class="math notranslate nohighlight">\(A\)</span>:</p>
<ul class="simple">
<li><p>The rowspace of <span class="math notranslate nohighlight">\(A\)</span> is in <span class="math notranslate nohighlight">\(R^n\)</span> with dimension <span class="math notranslate nohighlight">\(r\)</span></p></li>
<li><p>The columnspace of <span class="math notranslate nohighlight">\(A\)</span> is in <span class="math notranslate nohighlight">\(R^m\)</span> also with dimension <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>The nullspace of <span class="math notranslate nohighlight">\(A\)</span> is in <span class="math notranslate nohighlight">\(R^n\)</span> with dimension <span class="math notranslate nohighlight">\(n-r\)</span></p></li>
<li><p>The nullspace of <span class="math notranslate nohighlight">\(A^T\)</span> is in <span class="math notranslate nohighlight">\(R^m\)</span> with dimension <span class="math notranslate nohighlight">\(m-r\)</span>.</p></li>
</ul>
<p>Because the rowspace of <span class="math notranslate nohighlight">\(A\)</span> and the column space <span class="math notranslate nohighlight">\(A\)</span> have the same dimension then <span class="math notranslate nohighlight">\(A\)</span> is a the one-to-one mapping from the row space to the columnspace. In other words:</p>
<ul class="simple">
<li><p>For any <span class="math notranslate nohighlight">\(x\)</span> in the rowspace, we have that <span class="math notranslate nohighlight">\(Ax\)</span> is one point in the columnspace. If <span class="math notranslate nohighlight">\(x'\)</span> is another point in the row space different from <span class="math notranslate nohighlight">\(x\)</span>, we have <span class="math notranslate nohighlight">\(Ax\neq Ax'\)</span> (The mapping is one-to-one).</p></li>
<li><p>For any <span class="math notranslate nohighlight">\(y\)</span> in the columnspace, we can find <span class="math notranslate nohighlight">\(x\)</span> in the rowspace such that <span class="math notranslate nohighlight">\(Ax=y\)</span> (The mapping is onto).</p></li>
</ul>
<p>The above is not really a proof but hopefully there is sufficient information to convince yourself that this is true.</p>
<p><strong>Example 1:</strong> Let $<span class="math notranslate nohighlight">\(A=[1,2]\)</span><span class="math notranslate nohighlight">\(
we know that 
\)</span>r=m=1<span class="math notranslate nohighlight">\( and \)</span>n=2$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>TODO:</font></strong>  Calculate the pseudoinverse <span class="math notranslate nohighlight">\(A^+\)</span> of <span class="math notranslate nohighlight">\(A\)</span> using the <code class="docutils literal notranslate"><span class="pre">numpy.linalg</span></code> function <code class="docutils literal notranslate"><span class="pre">pinv</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>DO THIS:</font></strong>  Compute <span class="math notranslate nohighlight">\(AA^+\)</span> and <span class="math notranslate nohighlight">\(A^+A\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#put your code here</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>QUESTION:</font></strong> If <span class="math notranslate nohighlight">\(x\)</span> is in the nullspace of <span class="math notranslate nohighlight">\(A\)</span> what is the effect of <span class="math notranslate nohighlight">\(A^+Ax\)</span>?</p>
<p>Put your answer to the above question here</p>
<p>✅<strong><font color=red>QUESTION:</font></strong>  If <span class="math notranslate nohighlight">\(x\)</span> is in the rowspace of <span class="math notranslate nohighlight">\(A\)</span> what is the effect of <span class="math notranslate nohighlight">\(A^+Ax\)</span>?</p>
<p>Put your answer to the above question here</p>
<p><strong>Example 2:</strong> Let $<span class="math notranslate nohighlight">\(A=\begin{bmatrix}1\\2\end{bmatrix}\)</span><span class="math notranslate nohighlight">\(
we know that 
\)</span>r=n=1<span class="math notranslate nohighlight">\( and \)</span>m=2$. Then we have the left inverse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<p>✅<strong><font color=red>DO THIS:</font></strong> Calculate the pseudoinverse <span class="math notranslate nohighlight">\(A^+\)</span> of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Put your answer to the above question here</p>
<p>✅<strong><font color=red>DO THIS:</font></strong>  Calculate the left inverse of <span class="math notranslate nohighlight">\(A\)</span>, and verify that it is the same as <span class="math notranslate nohighlight">\(A^+\)</span>.</p>
<p>Put your answer to the above question here</p>
<hr class="docutils" />
<p><a name=LSF-Example:-Tracking-the-Planets></a></p>
</div>
<div class="section" id="lsf-example-tracking-the-planets">
<h2>4. LSF Example: Tracking the Planets<a class="headerlink" href="#lsf-example-tracking-the-planets" title="Permalink to this headline">¶</a></h2>
<img alt="composit image of the planets (and sun) in our solar system" src="https://images.squarespace-cdn.com/content/v1/537a20bce4b0c4a5e913ae77/1533010529325-0H1VQX4W19MAJCRGSTQF/ke17ZwdGBToddI8pDm48kJokDDWUnHQ7jYDwh9g9o2tZw-zPPgdn4jUwVcJE1ZvWQUxwkmyExglNqGp0IvTJZUJFbgE-7XRK3dMEBRBhUpy5LokhjEjEjl7mG0bnsgbfHG96R3ZWfXdsfqmd9qx-1I79M1PjxisoyjE5_sBXuWQ/solar-system-439046_640.jpg?format=1500w" width="100%">
<p>The following table lists the average distance from the sun to each of the first seven planets, using Earth’s distance as a unit of measure (AUs).</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Mercury</p></th>
<th class="head"><p>Venus</p></th>
<th class="head"><p>Earth</p></th>
<th class="head"><p>Mars</p></th>
<th class="head"><p>Jupiter</p></th>
<th class="head"><p>Satern</p></th>
<th class="head"><p>Uranus</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.39</p></td>
<td><p>0.72</p></td>
<td><p>1.00</p></td>
<td><p>1.52</p></td>
<td><p>5.20</p></td>
<td><p>9.54</p></td>
<td><p>19.2</p></td>
</tr>
</tbody>
</table>
<p>The following is a plot of the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="mf">5.20</span><span class="p">,</span> <span class="mf">9.54</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">]</span>
<span class="n">planets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Venus&#39;</span><span class="p">,</span> <span class="s1">&#39;Earth&#39;</span><span class="p">,</span> <span class="s1">&#39;Mars&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span> <span class="s1">&#39;Satern&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">distances</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">planets</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (AU)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong> that the above plot does not look like a line, and so finding the line of best fit is not fruitful.  It does, however look like an exponential curve (maybe a polynomial?). The following step transforms the distances using the numpy <strong><code class="docutils literal notranslate"><span class="pre">log</span></code></strong> function and generates a plot that looks much more linear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">log_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">planets</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (log(AU))&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For this question we are going to find the coefficients (<span class="math notranslate nohighlight">\(c\)</span>) for the best fit line of the form <span class="math notranslate nohighlight">\(c_1 + c_2i= \log{d}\)</span>, where <span class="math notranslate nohighlight">\(i\)</span> is the index of the planet and <span class="math notranslate nohighlight">\(d\)</span> is the distance.</p>
<p>The following code constructs this problem in the form <span class="math notranslate nohighlight">\(Ax=b\)</span> and define the <span class="math notranslate nohighlight">\(A\)</span> matrix and the <span class="math notranslate nohighlight">\(b\)</span> matrix as numpy matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)),</span><span class="n">ind</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">log_distances</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>DO THIS:</font></strong> Solve for the best fit of <span class="math notranslate nohighlight">\(Ax=b\)</span> and define a new variable <span class="math notranslate nohighlight">\(c\)</span> which consists of the of the two coefficients used to define the line <span class="math notranslate nohighlight">\((\log{d} = c_1 + c_2i)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##Put your answer here:</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>DO THIS:</font></strong> Modify the following code (as needed) to plot your best estimates of <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> against the provided data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Modify the following code</span>

<span class="n">est_log_distances</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">est_log_distances</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">log_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">planets</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (log(AU))&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can determine the quality of this line fit by calculating the root mean squared error between the estimate and the actual data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">log_distances</span><span class="p">)</span>  <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">est_log_distances</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">rmse</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can also make the plot on the original axis using the inverse of the log (i.e. the exp function):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">est_log_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">est_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">planets</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (AU)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The asteroid belt between Mars and Jupiter is what is left of a planet that broke apart.  Let’s the above calculation again but renumber so that  the index of Jupyter is 6, Saturn is 7 and Uranus is 8 as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="mf">5.20</span><span class="p">,</span> <span class="mf">9.54</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">]</span>
<span class="n">planets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Venus&#39;</span><span class="p">,</span> <span class="s1">&#39;Earth&#39;</span><span class="p">,</span> <span class="s1">&#39;Mars&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupiter&#39;</span><span class="p">,</span> <span class="s1">&#39;Satern&#39;</span><span class="p">,</span><span class="s1">&#39;Uranus&#39;</span><span class="p">]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>

<span class="n">log_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>DO THIS:</font></strong> Repeat the calculations from above with the updated model.  Plot the results and compare the RMSE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Copy and Paste code from above</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Copy and Paste code from above</span>
<span class="n">est_log_distances</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">ind</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">est_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">est_log_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">est_distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="n">planets</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (AU)&#39;</span><span class="p">)</span>

<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">log_distances</span><span class="p">)</span>  <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">est_log_distances</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">rmse</span>
<span class="c1">## Copy and Paste code from above</span>
</pre></div>
</div>
</div>
</div>
<p>This model of planet location was used to help discover Neptune and prompted people to look for the “missing planet” in position 5 which resulted in the discovery of the asteroid belt.  Based on the above model, what is the estimated  distance of the asteroid belt and Neptune (index 9) from the sun in AUs? (<strong>Hint:</strong> you can check your answer by searching for the answer on-line).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Put your prediction calcluation here</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><a name=LSF-Example:-Predator-Pray-Model></a></p>
</div>
<div class="section" id="lsf-example-predator-pray-model">
<h2>5. LSF Example: Predator Pray Model<a class="headerlink" href="#lsf-example-predator-pray-model" title="Permalink to this headline">¶</a></h2>
<img alt="Cartoon image of a cat chasing a wind up mouse" src="https://cdn.pixabay.com/photo/2016/06/14/15/46/cat-1456878_1280.png" width=30%>
<p>The following example example data comes from <a class="reference external" href="https://mathematica.stackexchange.com/questions/34761/find-parameters-of-odes-to-fit-solution-data">https://mathematica.stackexchange.com/questions/34761/find-parameters-of-odes-to-fit-solution-data</a> and represents some experimental data <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="math notranslate nohighlight">
\[dx = ax - bxy\]</div>
<div class="math notranslate nohighlight">
\[dy = -cy + dxy\]</div>
<p>The following code plots the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (* The first column is time &#39;t&#39;, the second column is coordinate &#39;x&#39;, and the last column is coordinate &#39;y&#39;. *)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">11</span><span class="p">,</span><span class="mf">45.79</span><span class="p">,</span><span class="mf">41.4</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mf">53.03</span><span class="p">,</span><span class="mf">38.9</span><span class="p">],[</span><span class="mi">13</span><span class="p">,</span><span class="mf">64.05</span><span class="p">,</span><span class="mf">36.78</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mf">75.4</span><span class="p">,</span><span class="mf">36.04</span><span class="p">],[</span><span class="mi">15</span><span class="p">,</span><span class="mf">90.36</span><span class="p">,</span><span class="mf">33.78</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mf">107.14</span><span class="p">,</span><span class="mf">35.4</span><span class="p">],[</span><span class="mi">17</span><span class="p">,</span><span class="mf">127.79</span><span class="p">,</span><span class="mf">34.68</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mf">150.77</span><span class="p">,</span><span class="mf">36.61</span><span class="p">],</span> <span class="p">[</span><span class="mi">19</span><span class="p">,</span><span class="mf">179.65</span><span class="p">,</span><span class="mf">37.71</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mf">211.82</span><span class="p">,</span><span class="mf">41.98</span><span class="p">],[</span><span class="mi">21</span><span class="p">,</span><span class="mf">249.91</span><span class="p">,</span><span class="mf">45.72</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">22</span><span class="p">,</span><span class="mf">291.31</span><span class="p">,</span><span class="mf">53.1</span><span class="p">],[</span><span class="mi">23</span><span class="p">,</span><span class="mf">334.95</span><span class="p">,</span><span class="mf">65.44</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mf">380.67</span><span class="p">,</span><span class="mf">83.</span><span class="p">],[</span><span class="mi">25</span><span class="p">,</span><span class="mf">420.28</span><span class="p">,</span><span class="mf">108.74</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">26</span><span class="p">,</span><span class="mf">445.56</span><span class="p">,</span><span class="mf">150.01</span><span class="p">],[</span><span class="mi">27</span><span class="p">,</span><span class="mf">447.63</span><span class="p">,</span><span class="mf">205.61</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">28</span><span class="p">,</span><span class="mf">414.04</span><span class="p">,</span><span class="mf">281.6</span><span class="p">],[</span><span class="mi">29</span><span class="p">,</span><span class="mf">347.04</span><span class="p">,</span><span class="mf">364.56</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mf">265.33</span><span class="p">,</span><span class="mf">440.3</span><span class="p">],[</span><span class="mi">31</span><span class="p">,</span><span class="mf">187.57</span><span class="p">,</span><span class="mf">489.68</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mf">128.</span><span class="p">,</span><span class="mf">512.95</span><span class="p">],[</span><span class="mi">33</span><span class="p">,</span><span class="mf">85.25</span><span class="p">,</span><span class="mf">510.01</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">34</span><span class="p">,</span><span class="mf">57.17</span><span class="p">,</span><span class="mf">491.06</span><span class="p">],[</span><span class="mi">35</span><span class="p">,</span><span class="mf">39.96</span><span class="p">,</span><span class="mf">462.22</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">36</span><span class="p">,</span><span class="mf">29.22</span><span class="p">,</span><span class="mf">430.15</span><span class="p">],[</span><span class="mi">37</span><span class="p">,</span><span class="mf">22.3</span><span class="p">,</span><span class="mf">396.95</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">38</span><span class="p">,</span><span class="mf">16.52</span><span class="p">,</span><span class="mf">364.87</span><span class="p">],[</span><span class="mi">39</span><span class="p">,</span><span class="mf">14.41</span><span class="p">,</span><span class="mf">333.16</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mf">11.58</span><span class="p">,</span><span class="mf">304.97</span><span class="p">],[</span><span class="mi">41</span><span class="p">,</span><span class="mf">10.41</span><span class="p">,</span><span class="mf">277.73</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">42</span><span class="p">,</span><span class="mf">10.17</span><span class="p">,</span><span class="mf">253.16</span><span class="p">],[</span><span class="mi">43</span><span class="p">,</span><span class="mf">7.86</span><span class="p">,</span><span class="mf">229.66</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">44</span><span class="p">,</span><span class="mf">9.23</span><span class="p">,</span><span class="mf">209.53</span><span class="p">],[</span><span class="mi">45</span><span class="p">,</span><span class="mf">8.22</span><span class="p">,</span><span class="mf">190.07</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">46</span><span class="p">,</span><span class="mf">8.76</span><span class="p">,</span><span class="mf">173.58</span><span class="p">],[</span><span class="mi">47</span><span class="p">,</span><span class="mf">7.9</span><span class="p">,</span><span class="mf">156.4</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mf">8.38</span><span class="p">,</span><span class="mf">143.05</span><span class="p">],[</span><span class="mi">49</span><span class="p">,</span><span class="mf">9.53</span><span class="p">,</span><span class="mf">130.75</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mf">9.33</span><span class="p">,</span><span class="mf">117.49</span><span class="p">],[</span><span class="mi">51</span><span class="p">,</span><span class="mf">9.72</span><span class="p">,</span><span class="mf">108.16</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mf">10.55</span><span class="p">,</span><span class="mf">98.08</span><span class="p">],[</span><span class="mi">53</span><span class="p">,</span><span class="mf">13.05</span><span class="p">,</span><span class="mf">88.91</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">54</span><span class="p">,</span><span class="mf">13.58</span><span class="p">,</span><span class="mf">82.28</span><span class="p">],[</span><span class="mi">55</span><span class="p">,</span><span class="mf">16.31</span><span class="p">,</span><span class="mf">75.42</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">56</span><span class="p">,</span><span class="mf">17.75</span><span class="p">,</span><span class="mf">69.58</span><span class="p">],[</span><span class="mi">57</span><span class="p">,</span><span class="mf">20.11</span><span class="p">,</span><span class="mf">62.58</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">58</span><span class="p">,</span><span class="mf">23.98</span><span class="p">,</span><span class="mf">59.22</span><span class="p">],[</span><span class="mi">59</span><span class="p">,</span><span class="mf">28.51</span><span class="p">,</span><span class="mf">54.91</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mf">31.61</span><span class="p">,</span><span class="mf">49.79</span><span class="p">],[</span><span class="mi">61</span><span class="p">,</span><span class="mf">37.13</span><span class="p">,</span><span class="mf">45.94</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">62</span><span class="p">,</span><span class="mf">45.06</span><span class="p">,</span><span class="mf">43.41</span><span class="p">],[</span><span class="mi">63</span><span class="p">,</span><span class="mf">53.4</span><span class="p">,</span><span class="mf">41.3</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">64</span><span class="p">,</span><span class="mf">62.39</span><span class="p">,</span><span class="mf">40.28</span><span class="p">],[</span><span class="mi">65</span><span class="p">,</span><span class="mf">72.89</span><span class="p">,</span><span class="mf">37.71</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">66</span><span class="p">,</span><span class="mf">86.92</span><span class="p">,</span><span class="mf">36.58</span><span class="p">],[</span><span class="mi">67</span><span class="p">,</span><span class="mf">103.32</span><span class="p">,</span><span class="mf">36.98</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">68</span><span class="p">,</span><span class="mf">121.7</span><span class="p">,</span><span class="mf">36.65</span><span class="p">],[</span><span class="mi">69</span><span class="p">,</span><span class="mf">144.86</span><span class="p">,</span><span class="mf">37.87</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">70</span><span class="p">,</span><span class="mf">171.92</span><span class="p">,</span><span class="mf">39.63</span><span class="p">],[</span><span class="mi">71</span><span class="p">,</span><span class="mf">202.51</span><span class="p">,</span><span class="mf">42.97</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">72</span><span class="p">,</span><span class="mf">237.69</span><span class="p">,</span><span class="mf">46.95</span><span class="p">],[</span><span class="mi">73</span><span class="p">,</span><span class="mf">276.77</span><span class="p">,</span><span class="mf">54.93</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">74</span><span class="p">,</span><span class="mf">319.76</span><span class="p">,</span><span class="mf">64.61</span><span class="p">],[</span><span class="mi">75</span><span class="p">,</span><span class="mf">362.05</span><span class="p">,</span><span class="mf">81.28</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">76</span><span class="p">,</span><span class="mf">400.11</span><span class="p">,</span><span class="mf">105.5</span><span class="p">],[</span><span class="mi">77</span><span class="p">,</span><span class="mf">427.79</span><span class="p">,</span><span class="mf">143.03</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">78</span><span class="p">,</span><span class="mf">434.56</span><span class="p">,</span><span class="mf">192.45</span><span class="p">],[</span><span class="mi">79</span><span class="p">,</span><span class="mf">410.31</span><span class="p">,</span><span class="mf">260.84</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">80</span><span class="p">,</span><span class="mf">354.18</span><span class="p">,</span><span class="mf">339.39</span><span class="p">],[</span><span class="mi">81</span><span class="p">,</span><span class="mf">278.49</span><span class="p">,</span><span class="mf">413.79</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">82</span><span class="p">,</span><span class="mf">203.72</span><span class="p">,</span><span class="mf">466.94</span><span class="p">],[</span><span class="mi">83</span><span class="p">,</span><span class="mf">141.06</span><span class="p">,</span><span class="mf">494.72</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">84</span><span class="p">,</span><span class="mf">95.08</span><span class="p">,</span><span class="mf">499.37</span><span class="p">],[</span><span class="mi">85</span><span class="p">,</span><span class="mf">66.76</span><span class="p">,</span><span class="mf">484.58</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">86</span><span class="p">,</span><span class="mf">45.41</span><span class="p">,</span><span class="mf">460.63</span><span class="p">],[</span><span class="mi">87</span><span class="p">,</span><span class="mf">33.13</span><span class="p">,</span><span class="mf">429.79</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">88</span><span class="p">,</span><span class="mf">25.89</span><span class="p">,</span><span class="mf">398.77</span><span class="p">],[</span><span class="mi">89</span><span class="p">,</span><span class="mf">20.51</span><span class="p">,</span><span class="mf">366.49</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="mf">17.11</span><span class="p">,</span><span class="mf">336.56</span><span class="p">],[</span><span class="mi">91</span><span class="p">,</span><span class="mf">12.69</span><span class="p">,</span><span class="mf">306.39</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">92</span><span class="p">,</span><span class="mf">11.76</span><span class="p">,</span><span class="mf">279.53</span><span class="p">],[</span><span class="mi">93</span><span class="p">,</span><span class="mf">11.22</span><span class="p">,</span><span class="mf">254.95</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">94</span><span class="p">,</span><span class="mf">10.29</span><span class="p">,</span><span class="mf">233.5</span><span class="p">],[</span><span class="mi">95</span><span class="p">,</span><span class="mf">8.82</span><span class="p">,</span><span class="mf">212.74</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">96</span><span class="p">,</span><span class="mf">9.51</span><span class="p">,</span><span class="mf">193.61</span><span class="p">],[</span><span class="mi">97</span><span class="p">,</span><span class="mf">8.69</span><span class="p">,</span><span class="mf">175.01</span><span class="p">],</span>
      <span class="p">[</span><span class="mi">98</span><span class="p">,</span><span class="mf">9.53</span><span class="p">,</span><span class="mf">160.59</span><span class="p">],[</span><span class="mi">99</span><span class="p">,</span><span class="mf">8.68</span><span class="p">,</span><span class="mf">146.12</span><span class="p">],[</span><span class="mi">100</span><span class="p">,</span><span class="mf">10.82</span><span class="p">,</span><span class="mf">131.85</span><span class="p">]]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;prey&#39;</span><span class="p">,</span> <span class="s1">&#39;preditor&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>QUESTION</font></strong> What is the formula for numerical differentiation?</p>
<p><strong>Hint.</strong> Think slope.</p>
<p>✅ <strong><font color=red>DO THIS</font></strong> Use Numerical Differentiation to calculate <span class="math notranslate nohighlight">\(dx\)</span> and <span class="math notranslate nohighlight">\(dy\)</span> from <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. See if you can plot <span class="math notranslate nohighlight">\(x,dx\)</span> nad <span class="math notranslate nohighlight">\(y,dy\)</span> on a couple of plots. Use the plots to try and check to make sure your results make senes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Put your answer here</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>DO THIS</font></strong>  Formulate two linear systems (<span class="math notranslate nohighlight">\(Ax=b\)</span>) and solve them using LSF as we did in the pre-class. Use one to solve the first ODE and the second to solve the second ODE.  Remember, we are trying to estimate values for <span class="math notranslate nohighlight">\(a,b,c,d\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Put your answer here.</span>
</pre></div>
</div>
</div>
</div>
<p>Assuming everything worked the following should plot the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="c1"># The above ODE model sutiable for ODEINT</span>
<span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="n">position</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span>

<span class="c1"># Integrate equations over the time grid, t.</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>

<span class="c1">#Plot the model on the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ret</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;x est&#39;</span><span class="p">,</span> <span class="s1">&#39;y est&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p><a name=LSF-Example:-Estimating-the-best-Ellipses></a></p>
</div>
<div class="section" id="lsf-example-estimating-the-best-ellipses">
<h2>6. LSF Example: Estimating the best Ellipses<a class="headerlink" href="#lsf-example-estimating-the-best-ellipses" title="Permalink to this headline">¶</a></h2>
<img alt="Animated image of planets revolving around the sun" src="https://thumbs.gfycat.com/WhimsicalUnequaledBuzzard-max-1mb.gif" width="30%">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">(</span><span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now consider the following sets of points. Think of these as observations of planet moving in an elliptical orbit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mi">2</span><span class="o">*-</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In this problem we want to try to fit an ellipse to the above data.  First lets look at a general equation for an ellipse:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$$ \frac{(u+x)^2}{a^2} + \frac{(v+y)^2}{b^2} = 1 \qquad \qquad \text{    (1)}$$
</pre></div>
</div>
<p>Where <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates for the center of the ellipse and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are the lengths of the axes sizes of the ellipse.  A quick search on how to plot an ellipse in python comes up with the following example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Code from: https://stackoverflow.com/questions/10952060/plot-ellipse-with-matplotlib-pyplot-python</span>

<span class="n">u</span><span class="o">=</span><span class="mf">1.</span>     <span class="c1">#x-position of the center</span>
<span class="n">v</span><span class="o">=</span><span class="mf">0.5</span>    <span class="c1">#y-position of the center</span>
<span class="n">a</span><span class="o">=</span><span class="mf">2.</span>     <span class="c1">#radius on the x-axis</span>
<span class="n">b</span><span class="o">=</span><span class="mf">1.5</span>    <span class="c1">#radius on the y-axis</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">u</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">,</span> <span class="n">v</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notice this example uses equations of the form:</p>
<div class="math notranslate nohighlight">
\[t = [0, \dots, 2\pi]\]</div>
<div class="math notranslate nohighlight">
\[x = u+a\cos(t)\]</div>
<div class="math notranslate nohighlight">
\[y = v+b\sin(t)\]</div>
<p>Turns out that this form of the equation is easier to plot and the variables <span class="math notranslate nohighlight">\(u,v,a,b\)</span> are the same as our original equation.</p>
<p>Now lets expand the original equation (equation 1 from above) and we get the following:</p>
<div class="math notranslate nohighlight">
\[x^2−2ux-u^2+y^2−2vy+v^2=r^2 \qquad \qquad \text{    (2)}\]</div>
<p>✅ <strong><font color=red>QUESTION:</font></strong> Why can’t we convert equation 2 into the form <span class="math notranslate nohighlight">\(Ax=b\)</span> and solve using Least Squares Fit? Discuss with your group and be prepared to share your thought with the class.</p>
<p>Put your answer to the above question here.</p>
<p>If we look at our data more closely we can simplify equations 1 and 2 by assuming the the centroid (u,v) is at the origin.  This assumption results in the following equation:</p>
<div class="math notranslate nohighlight">
\[ \frac{x^2}{a^2} + \frac{y^2}{b^2} = 1 \]</div>
<p>Notice we can rewrite this into a standard linear set of equations by defining <span class="math notranslate nohighlight">\(c_o = \frac{1}{a^2}\)</span> and <span class="math notranslate nohighlight">\(c_1 = \frac{1}{b^2}\)</span> and rewriting the equation as follows:</p>
<div class="math notranslate nohighlight">
\[ c_0x^2 + c_1y^2 = 1 \]</div>
<p>✅ <strong><font color=red>DO THIS</font></strong> Given that we know the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> values of our point observations, equation 4 is now linear and can be solved using Least Squares Fit.  Using the observation points from above construct  <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> as numpy matrixes for the overdefined system <span class="math notranslate nohighlight">\(Ax=b\)</span></p>
<p>Put your answer to the above question here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>✅ <strong><font color=red>DO THIS:</font></strong> Solve the above over defined system of linear equations for <span class="math notranslate nohighlight">\(c_0\)</span> and <span class="math notranslate nohighlight">\(c_1\)</span> using LSF.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Put your answer to the above question here</span>
</pre></div>
</div>
</div>
</div>
<p>Assuming we have <span class="math notranslate nohighlight">\(c\)</span> in the correct format, we can now calculate <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> from the solution for <span class="math notranslate nohighlight">\(c_o\)</span> and <span class="math notranslate nohighlight">\(c_1\)</span> calculated in the previous step and plot using our plotting code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> 
<span class="n">a</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">=</span><span class="mi">0</span>     <span class="c1">#x-position of the center</span>
<span class="n">v</span><span class="o">=</span><span class="mi">0</span>     <span class="c1">#y-position of the center</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">,</span> <span class="n">v</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="109--LSF_Review_pre-class-assignment.html" title="previous page">109 Pre-Class Assignment: Least Squares Fit (Regression) and Review</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dirk Colbry, adapted by Matthew Mills for the summer course<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>